# Test Coverage（言語/フレームワーク不問）

カバレッジを確認し、足りないテスト（特に分岐/失敗系/境界値）を補う。

## 前提

- 特定の言語・テストランナーに固定しない（リポジトリの実態に合わせる）
- カバレッジは環境/ランナーの対応状況に依存する（非対応なら “分岐/失敗系/境界値の追加” で実質的に補う）
- プロジェクトルールにより、テスト追加時は **テスト観点表（Markdown）** と **Given/When/Then コメント**が必須

## 手順

1. カバレッジ付きでテスト実行（環境が対応している場合）
   - 例: `pytest --cov`, `go test -cover ./...`, `dotnet test /p:CollectCoverage=true`, `npm test -- --coverage`, `mvn test` + coverage plugin など
   - （任意）最小スコープで実行できるなら、それを優先（該当テスト/パッケージ/フィルタ）

2. 出力（テキスト）または生成されたレポートを確認し、**80%未満**の対象を列挙

3. 80%未満の対象ごとに、未カバー箇所を分析
   - **認可**（401/403）
   - **バリデーション**（必須/形式/境界値/NULL/空）
   - **例外・エラーパス**（404/409、競合、期限切れ、外部API失敗など）
   - **DB整合性**（トランザクション/ユニーク制約/巻き戻し）
   - **N+1/性能劣化**（クエリ増加、ページング不足、キャッシュ欠如）

4. テストを追加（プロジェクトの構成に合わせる）
   - Unit: 純粋ロジック（サービス/ドメイン/関数/バリデータ）
   - Integration: HTTP/DB/IO が絡む経路（必要なら）
   - 外部依存は fake/mock/stub を使って失敗系も再現（HTTP、キュー、メール、FS など）

5. 追加テストを最小スコープで実行 → 緑化

6. 可能なら再度カバレッジを実行し、**before/after** を提示

## 置き換えコマンド例（プロジェクトに合わせて選ぶ）

```bash
# カバレッジ
# pytest --cov
# go test -cover ./...
# dotnet test /p:CollectCoverage=true
# npm test -- --coverage

# 最小スコープでテスト
# pytest path/to/test_file.py -q
# go test ./... -run TestName
# dotnet test --filter FullyQualifiedName~TestName
```

## 目標
- 目標: **全体80%+**（達成困難なら、ビジネス影響の大きい分岐と主要エラーパスを優先して網羅）
